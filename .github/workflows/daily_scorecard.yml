name: OpenSSF Scorecard

on:
  push:
    branches: [main]   # run on pushes to main
  pull_request:        # run on PRs
  schedule:            # optional: weekly scan
    - cron: "0 0 * * 0"   # every Sunday at 00:00 UTC

permissions:
  security-events: write
  id-token: write
  contents: read
  issues: read
  pull-requests: read
  checks: read

jobs:
  scorecard:
    runs-on: ubuntu-latest

    steps:
      # Checkout code
      - name: Checkout repo
        uses: actions/checkout@v3

      # Run OpenSSF Scorecard
      - name: Run Scorecard
        uses: ossf/scorecard-action@v2
        with:
          results_file: scorecard-results.json   # save JSON results
          publish_results: true                   # publish to OpenSSF Scorecard API
          results_format: sarif                   # optional: for GitHub security scanning

      # Upload SARIF results to GitHub Security (optional)
      - name: Upload SARIF results
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: scorecard-results.sarif
